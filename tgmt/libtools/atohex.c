#include    <ctype.h>
#include    <sys/types.h>

#define     NULL    (u_char*)0

static u_char _hexshift[] = {
000,001,002,003,004,005,006,007,010,011,012,013,014,015,016,017,
020,021,022,023,024,025,026,027,030,031,032,033,034,035,036,037,
040,041,042,043,044,045,046,047,050,051,052,053,054,055,056,057,
000,001,002,003,004,005,006,007,010,011,072,073,074,075,076,077,    /* 0-9 */
0100,012,013,014,015,016,017,0107,0110,0111,0112,0113,0114,0115,0116,0117,    /* A-Z */
0120,0121,0122,0123,0124,0125,0126,0127,0130,0131,0132,0133,0134,0135,0136,0137,
0140,012,013,014,015,016,017,0147,0150,0151,0152,0153,0154,0155,0156,0157,    /* a-z */
};

u_char *atohex( u_char *s, const char *b, int len)
{   
    int i;
    u_char upper, lower;

    for( i=0; i<len; i++) {
        if( isxdigit( upper=*b++) && isxdigit( lower=*b++))
            s[ i] = _hexshift[ lower] + (_hexshift[ upper]<<4);
        else
            return( NULL);
    }
    return( s);

}       /* ENDE atohex */
